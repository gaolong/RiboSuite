params {

    adapter_sequence = null

    min_length = 25
    max_length = 42

    enable_umi         = false
    umi_extract_method = "regex"
    umi_bc_pattern     = '^(?P<umi_1>.{8}).+$'

    contam_index = "/data/holwm/home/gaolong/projects/RiboSuite/reference/human/GRCh38/contam/bowtie2_idx/human_contam"
    star_index   = "/data/holwm/home/gaolong/projects/RiboSuite/reference/human/GRCh38/star"

    metagene_window          = 50
    metagene_max_tx_per_gene = 1

    outdir = "results"

    rna_paired       = true
    rna_strandedness = 0

    star_quantmode = false
}



profiles {

    // ============================================================
    // Local testing
    // ============================================================
    standard {

        process {
            executor = 'local'
            cpus     = 1
            memory   = '8 GB'
        }

        conda {
            enabled = true
        }
    }


    // ============================================================
    // HPC (PBS)
    // ============================================================
    hpc {

        // -----------------------------
        // Shared resource presets
        // -----------------------------
        BIG_MEM   = '32 GB'
        BIG_CPUS = 4
        BIG_TIME = '12h'

        process {

            executor = 'local'
            queue    = 'workq'
            cpus     = 4
            memory   = '16 GB'
            time     = '24h'

            errorStrategy = 'retry'
            maxRetries    = 2

            // -----------------------------
            // Heavy process overrides
            // -----------------------------

            withName: CUTADAPT_TRIM {
                cpus   = BIG_CPUS
                memory = BIG_MEM
                time   = "2h"
            }
            
            withName: BOWTIE2_FILTER {
                cpus   = BIG_CPUS
                memory = BIG_MEM
                time   = BIG_TIME
            }

            withName: STAR_ALIGN {
                cpus   = BIG_CPUS
                memory = BIG_MEM
                time   = BIG_TIME
            }

            withName: SAMTOOLS_INDEX {
                cpus   = BIG_CPUS
                memory = BIG_MEM
                time   = '2h'
            }

            withName: UMI_DEDUP {
                cpus   = BIG_CPUS
                memory = BIG_MEM
                time   = "2h"
            }
        }

        executor {
            queueSize = 50
        }

        conda {
            enabled = true
        }

        cleanup = false
    }

    // ============================================================
    // PBS batch submission (REAL cluster usage)
    // ============================================================
    pbs {

        BIG_MEM   = '32 GB'
        BIG_CPUS = 4
        BIG_TIME = '12h'

        process {

            executor = 'pbs'
            queue    = 'workq'

            cpus     = 1
            memory   = '16 GB'
            time     = '24h'

            errorStrategy = 'retry'
            maxRetries    = 2

            withName: CUTADAPT_TRIM {
                cpus   = BIG_CPUS
                memory = BIG_MEM
                time   = '2h'
            }

            withName: BOWTIE2_FILTER {
                cpus   = BIG_CPUS
                memory = BIG_MEM
                time   = BIG_TIME
            }

            withName: STAR_ALIGN {
                cpus   = BIG_CPUS
                memory = BIG_MEM
                time   = BIG_TIME
            }

            withName: SAMTOOLS_INDEX {
                cpus   = BIG_CPUS
                memory = BIG_MEM
                time   = '2h'
            }
        }

        executor {
            queueSize = 6
        }

        conda {
            enabled = true
        }

        cleanup = false
    }

}
